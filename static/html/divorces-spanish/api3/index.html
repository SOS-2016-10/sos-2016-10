<!-- Pagina de /divorces-spanish/api3 "https://sos-2016-10.herokuapp.com/divorces-spanish/api3" -->
<html>
<head>
  <link href="/style.css" rel="stylesheet" type="text/css">
  <title>API 3 - Divorces Spanish vs Beers</title>

  <!-- JQuery -->
  <script src="https://code.jquery.com/jquery-1.12.2.min.js"></script>

  <!-- ***************** GOOGLE ********************* -->
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>

  <!-- /////////////////////////////////////////////////////////////////////////// GOOGLE ///////////////////// -->
  <script type="text/javascript">
  google.load("visualization", "1", {packages:["corechart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart() {
    var datos = [];
    var options;
    //Beers
    var request = $.ajax({
      url: "/beers"
    });

    request.done(function(data,status,jqXHR){
      //var datos = [];
      datos.push(['string', 'number']); ////datos.push(['Task', 'athletes']);

      for(var i=0;i<50;i++){//for(var i in data){ //Recorro todo los objetos
        var obj = data[i];
        datos.push([obj.name,obj.beer_id]); //.abv
      }

      console.warn(datos);
      //var data = google.visualization.arrayToDataTable(datos);
      options = {
        title: 'Divorces Spanish vs Beers'
      };

      //var chart = new google.visualization.PieChart(document.getElementById('piechart'));

      //chart.draw(data, options);
    });

    //DivorcesSpanish
    var request = $.ajax({
      url: "/api/v1/divorces-spanish?apikey=multiPlan_C4_sos-2016-10-jldl_ag"
    });
    request.done(function(data,status,jqXHR){
      if(datos.length == 0){
        datos.push(['string', 'number']);
      }
      for(var i in data){ //Recorro todo los objetos
        var obj = data[i];
        datos.push([obj.autonomous_community,obj.year]);
      }

      var chart = new google.visualization.PieChart(document.getElementById('piechart'));
      chart.draw(google.visualization.arrayToDataTable(datos), options);
    });
  }
  </script>
</head>
<body>
  <!-- ***************** GOOGLE CHART ********************* -->
	<div id="piechart" style="width: 900px; height: 500px;"></div>
</body>
</html>
